
<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Adivinhe a Carta ‚Äî Vers√£o V17 üé©üÉè</title>
  <style>
    :root{ --cardW:160px; --cardH:240px; }
    body{margin:0;font-family:Arial,Helvetica,sans-serif;background:linear-gradient(180deg,#041024,#071226);color:#fff;display:flex;flex-direction:column;align-items:center;padding:16px;min-height:100vh;}
    h1{color:#ffd54f;font-size:28px;margin:10px 0;}
    p{color:#cfe8ff;max-width:900px;text-align:center;}
    .board{display:flex;gap:24px;justify-content:center;margin-top:20px;}
    .column{display:flex;flex-direction:column;gap:12px;}
    .scene{width:var(--cardW);height:var(--cardH);perspective:1000px;}
    .card{width:100%;height:100%;position:relative;transform-style:preserve-3d;transition:transform .6s;border-radius:10px;box-shadow:0 8px 20px rgba(0,0,0,.6);cursor:pointer;}
    .card.revealed{transform:rotateY(180deg);}
    .face{position:absolute;width:100%;height:100%;backface-visibility:hidden;border-radius:10px;display:flex;flex-direction:column;justify-content:space-between;padding:10px;}
    .front{background:#fff;color:#000;transform:rotateY(180deg);}
    .back{background:linear-gradient(135deg,#003366,#0055aa);color:#fff;display:flex;align-items:center;justify-content:center;font-size:22px;font-weight:bold;}
    .value-top,.value-bottom{font-size:18px;}
    .value-bottom{transform:rotate(180deg);}
    .suit-center{font-size:46px;text-align:center;line-height:1;}
    .red{color:#c62828;} .black{color:#111;}
    .controls{margin-top:20px;display:flex;flex-direction:column;align-items:center;gap:14px;}
    .question{font-size:20px;margin-bottom:8px;}
    .radio-group{display:flex;gap:28px;justify-content:center;flex-wrap:wrap;}
    .radio-option{font-size:18px;display:flex;align-items:center;gap:6px;padding:6px 10px;border-radius:8px;}
    .col1{color:#e53935;} .col2{color:#43a047;} .col3{color:#1e88e5;}
    input[type="radio"]{transform:scale(1.4);}
    .ghost{background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.1);color:#fff;padding:10px 14px;border-radius:8px;cursor:pointer;}
    .resultado{margin-top:18px;font-size:20px;color:#ffd54f;text-align:center;min-height:76px;}
    .avatars{margin-top:14px;} .avatar{width:96px;margin:8px;}
    .estrelas{position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:0;overflow:hidden;}
  </style>
</head>
<body>
  <!-- VLibras Plugin Integration -->
  <div vw class="enabled"><div vw-access-button class="active"></div><div vw-plugin-wrapper><div class="vw-plugin-top-wrapper"></div></div></div>
  <script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
  <script>new window.VLibras.Widget('https://vlibras.gov.br/app');</script>

  <div class="estrelas"></div>
  <h1>üé© Adivinhe a Carta</h1>
  <p>Pense em uma carta, indique em qual coluna ela est√° em cada rodada, e ao final ela ser√° revelada!</p>
  <div class="avatars">
    <img src="avatar_barba.png" class="avatar" alt="Mago com barba">
    <img src="avatar_sem_barba.png" class="avatar" alt="Mago sem barba">
  </div>

  <div id="board" class="board"></div>

  <div class="controls">
    <div class="question">üëâ Em qual coluna est√° a sua carta?</div>
    <div class="radio-group">
      <label class="radio-option col1"><input type="radio" name="col" value="0"> Coluna 1</label>
      <label class="radio-option col2"><input type="radio" name="col" value="1"> Coluna 2</label>
      <label class="radio-option col3"><input type="radio" name="col" value="2"> Coluna 3</label>
    </div>
    <button class="ghost" id="revelar" style="display:none;">üé© Revelar Carta</button>
    <button class="ghost" id="reiniciar">üîÑ Participar novamente</button>
    <button class="ghost" id="toggleVoice">üîä Voz: Ligada</button>
  </div>

  <div class="resultado" id="resultado">Rodada: <span id="rodada">1</span> de 3</div>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>

  <script>
    const FULL_DECK = [{"id": 1, "label": "A\u2665", "rank": "A", "suit": {"sym": "\u2665", "name": "Copas", "color": "red"}}, {"id": 2, "label": "2\u2665", "rank": "2", "suit": {"sym": "\u2665", "name": "Copas", "color": "red"}}, {"id": 3, "label": "3\u2665", "rank": "3", "suit": {"sym": "\u2665", "name": "Copas", "color": "red"}}, {"id": 4, "label": "4\u2665", "rank": "4", "suit": {"sym": "\u2665", "name": "Copas", "color": "red"}}, {"id": 5, "label": "5\u2665", "rank": "5", "suit": {"sym": "\u2665", "name": "Copas", "color": "red"}}, {"id": 6, "label": "6\u2665", "rank": "6", "suit": {"sym": "\u2665", "name": "Copas", "color": "red"}}, {"id": 7, "label": "7\u2665", "rank": "7", "suit": {"sym": "\u2665", "name": "Copas", "color": "red"}}, {"id": 8, "label": "8\u2665", "rank": "8", "suit": {"sym": "\u2665", "name": "Copas", "color": "red"}}, {"id": 9, "label": "9\u2665", "rank": "9", "suit": {"sym": "\u2665", "name": "Copas", "color": "red"}}, {"id": 10, "label": "10\u2665", "rank": "10", "suit": {"sym": "\u2665", "name": "Copas", "color": "red"}}, {"id": 11, "label": "J\u2665", "rank": "J", "suit": {"sym": "\u2665", "name": "Copas", "color": "red"}}, {"id": 12, "label": "Q\u2665", "rank": "Q", "suit": {"sym": "\u2665", "name": "Copas", "color": "red"}}, {"id": 13, "label": "K\u2665", "rank": "K", "suit": {"sym": "\u2665", "name": "Copas", "color": "red"}}, {"id": 14, "label": "A\u2666", "rank": "A", "suit": {"sym": "\u2666", "name": "Ouros", "color": "red"}}, {"id": 15, "label": "2\u2666", "rank": "2", "suit": {"sym": "\u2666", "name": "Ouros", "color": "red"}}, {"id": 16, "label": "3\u2666", "rank": "3", "suit": {"sym": "\u2666", "name": "Ouros", "color": "red"}}, {"id": 17, "label": "4\u2666", "rank": "4", "suit": {"sym": "\u2666", "name": "Ouros", "color": "red"}}, {"id": 18, "label": "5\u2666", "rank": "5", "suit": {"sym": "\u2666", "name": "Ouros", "color": "red"}}, {"id": 19, "label": "6\u2666", "rank": "6", "suit": {"sym": "\u2666", "name": "Ouros", "color": "red"}}, {"id": 20, "label": "7\u2666", "rank": "7", "suit": {"sym": "\u2666", "name": "Ouros", "color": "red"}}, {"id": 21, "label": "8\u2666", "rank": "8", "suit": {"sym": "\u2666", "name": "Ouros", "color": "red"}}, {"id": 22, "label": "9\u2666", "rank": "9", "suit": {"sym": "\u2666", "name": "Ouros", "color": "red"}}, {"id": 23, "label": "10\u2666", "rank": "10", "suit": {"sym": "\u2666", "name": "Ouros", "color": "red"}}, {"id": 24, "label": "J\u2666", "rank": "J", "suit": {"sym": "\u2666", "name": "Ouros", "color": "red"}}, {"id": 25, "label": "Q\u2666", "rank": "Q", "suit": {"sym": "\u2666", "name": "Ouros", "color": "red"}}, {"id": 26, "label": "K\u2666", "rank": "K", "suit": {"sym": "\u2666", "name": "Ouros", "color": "red"}}, {"id": 27, "label": "A\u2663", "rank": "A", "suit": {"sym": "\u2663", "name": "Paus", "color": "black"}}, {"id": 28, "label": "2\u2663", "rank": "2", "suit": {"sym": "\u2663", "name": "Paus", "color": "black"}}, {"id": 29, "label": "3\u2663", "rank": "3", "suit": {"sym": "\u2663", "name": "Paus", "color": "black"}}, {"id": 30, "label": "4\u2663", "rank": "4", "suit": {"sym": "\u2663", "name": "Paus", "color": "black"}}, {"id": 31, "label": "5\u2663", "rank": "5", "suit": {"sym": "\u2663", "name": "Paus", "color": "black"}}, {"id": 32, "label": "6\u2663", "rank": "6", "suit": {"sym": "\u2663", "name": "Paus", "color": "black"}}, {"id": 33, "label": "7\u2663", "rank": "7", "suit": {"sym": "\u2663", "name": "Paus", "color": "black"}}, {"id": 34, "label": "8\u2663", "rank": "8", "suit": {"sym": "\u2663", "name": "Paus", "color": "black"}}, {"id": 35, "label": "9\u2663", "rank": "9", "suit": {"sym": "\u2663", "name": "Paus", "color": "black"}}, {"id": 36, "label": "10\u2663", "rank": "10", "suit": {"sym": "\u2663", "name": "Paus", "color": "black"}}, {"id": 37, "label": "J\u2663", "rank": "J", "suit": {"sym": "\u2663", "name": "Paus", "color": "black"}}, {"id": 38, "label": "Q\u2663", "rank": "Q", "suit": {"sym": "\u2663", "name": "Paus", "color": "black"}}, {"id": 39, "label": "K\u2663", "rank": "K", "suit": {"sym": "\u2663", "name": "Paus", "color": "black"}}, {"id": 40, "label": "A\u2660", "rank": "A", "suit": {"sym": "\u2660", "name": "Espadas", "color": "black"}}, {"id": 41, "label": "2\u2660", "rank": "2", "suit": {"sym": "\u2660", "name": "Espadas", "color": "black"}}, {"id": 42, "label": "3\u2660", "rank": "3", "suit": {"sym": "\u2660", "name": "Espadas", "color": "black"}}, {"id": 43, "label": "4\u2660", "rank": "4", "suit": {"sym": "\u2660", "name": "Espadas", "color": "black"}}, {"id": 44, "label": "5\u2660", "rank": "5", "suit": {"sym": "\u2660", "name": "Espadas", "color": "black"}}, {"id": 45, "label": "6\u2660", "rank": "6", "suit": {"sym": "\u2660", "name": "Espadas", "color": "black"}}, {"id": 46, "label": "7\u2660", "rank": "7", "suit": {"sym": "\u2660", "name": "Espadas", "color": "black"}}, {"id": 47, "label": "8\u2660", "rank": "8", "suit": {"sym": "\u2660", "name": "Espadas", "color": "black"}}, {"id": 48, "label": "9\u2660", "rank": "9", "suit": {"sym": "\u2660", "name": "Espadas", "color": "black"}}, {"id": 49, "label": "10\u2660", "rank": "10", "suit": {"sym": "\u2660", "name": "Espadas", "color": "black"}}, {"id": 50, "label": "J\u2660", "rank": "J", "suit": {"sym": "\u2660", "name": "Espadas", "color": "black"}}, {"id": 51, "label": "Q\u2660", "rank": "Q", "suit": {"sym": "\u2660", "name": "Espadas", "color": "black"}}, {"id": 52, "label": "K\u2660", "rank": "K", "suit": {"sym": "\u2660", "name": "Espadas", "color": "black"}}];
    function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;}

    let rodada=1,columns=[[],[],[]],selectedCards=[],voiceEnabled=true;

    document.getElementById('toggleVoice').onclick=()=>{voiceEnabled=!voiceEnabled;document.getElementById('toggleVoice').textContent=voiceEnabled?'üîä Voz: Ligada':'üîá Voz: Desligada';};

    function speak(t){if(!voiceEnabled)return;try{let u=new SpeechSynthesisUtterance(t);u.lang='pt-BR';speechSynthesis.cancel();speechSynthesis.speak(u);}catch(e){}}

    function startGame(){
      rodada=1;
      const rodadaElement = document.getElementById('rodada');
      if (rodadaElement) {rodadaElement.textContent = rodada;}
      document.getElementById('resultado').textContent='Rodada: '+rodada+' de 3';
      document.getElementById('revelar').style.display='none';
      document.querySelectorAll('input[name="col"]').forEach(r=>r.checked=false);
      let deck=shuffle(Array.from(FULL_DECK));
      selectedCards=deck.slice(0,21);
      dealColumns(selectedCards);
      renderBoard(true);
      speak('Pense em uma carta entre as 21 mostradas. Em qual coluna ela est√°?');
    }

    function dealColumns(list){
      columns=[[],[],[]];
      for(let i=0;i<21;i++){columns[i%3].push(list[i]);}
    }

    function renderBoard(autoFlip){
      const board=document.getElementById('board');
      board.innerHTML='';
      for(let c=0;c<3;c++){
        const colDiv=document.createElement('div');
        colDiv.className='column';
        for(let i=0;i<columns[c].length;i++){
          const card=columns[c][i];
          const scene=document.createElement('div'); scene.className='scene';
          const cardEl=document.createElement('div'); cardEl.className='card';
          const front=document.createElement('div'); front.className='face front';
          front.innerHTML='<div class="value-top '+(card.suit.color==='red'?'red':'black')+'">'+card.rank+card.suit.sym+'</div>'+
                          '<div class="suit-center '+(card.suit.color==='red'?'red':'black')+'">'+card.suit.sym+'</div>'+
                          '<div class="value-bottom '+(card.suit.color==='red'?'red':'black')+'">'+card.rank+card.suit.sym+'</div>';
          const back=document.createElement('div'); back.className='face back'; back.textContent='MATEM√ÅGICA';
          cardEl.appendChild(front); cardEl.appendChild(back);
          scene.appendChild(cardEl);
          colDiv.appendChild(scene);
        }
        board.appendChild(colDiv);
      }
      const all=document.querySelectorAll('.card');
      all.forEach(el=>el.classList.remove('revealed'));
      if(autoFlip){
        setTimeout(()=>{
          const cards=document.querySelectorAll('.card');
          cards.forEach((el,i)=>{
            setTimeout(()=> el.classList.add('revealed'), i*80);
          });
        },500);
      }
    }

    function chooseColumn(colIndex){
      if(rodada>3)return;
      let order;
      if(colIndex===0)order=[1,0,2];
      else if(colIndex===1)order=[0,1,2];
      else order=[0,2,1];
      let newList=[];
      for(let r=0;r<7;r++){
        for(let k=0;k<3;k++){
          let col=columns[order[k]];
          newList.push(col[r]);
        }
      }
      selectedCards=newList.slice();
      dealColumns(selectedCards);
      rodada+=1;
      const rodadaElement = document.getElementById('rodada');
      if (rodadaElement) {rodadaElement.textContent = Math.min(rodada,3);}
      if(rodada<=3){
        renderBoard(true);
        speak('Em qual coluna est√° agora a sua carta?');
        document.querySelectorAll('input[name="col"]').forEach(r=>r.checked=false);
      } else {
        document.getElementById('revelar').style.display='inline-block';
        speak('Clique em revelar carta para ver o resultado.');
      }
    }

    function finalize(){
      const chosen=selectedCards[10];  // The correct card is at index 10 (11th card)
      document.getElementById('resultado').innerHTML='üé© <strong>A carta escolhida √©: '+chosen.label+' ('+chosen.rank+' de '+chosen.suit.name+')</strong><br>üôå Agradecemos a sua participa√ß√£o.<br>üë®‚Äçüè´ Professores: Rafael Oliveira e Ronaldo Soares';
      speak('A carta escolhida √© '+chosen.rank+' de '+chosen.suit.name);
      confetti({particleCount:300,spread:160,origin:{y:0.5}});
    }

    document.querySelectorAll('input[name="col"]').forEach(r=>{
      r.addEventListener('change', e=>chooseColumn(parseInt(e.target.value)));
    });
    document.getElementById('reiniciar').onclick=()=>startGame();
    document.getElementById('revelar').onclick=()=>finalize();

    window.onload=()=>startGame();
  </script>
</body>
</html>
